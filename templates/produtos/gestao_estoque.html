{% extends 'base.html' %}

{% block title %}Gestão de Estoque{% endblock %}

{% block content %}
<div class="container">
    <nav>
        <a href="{% url 'principal' %}">← Voltar à Página Principal</a>
    </nav>
    <h2>Gestão de Estoque</h2>
    <p>Produtos listados em ordem alfabética.</p>

    <table>
        <thead>
            <tr>
                <th>Produto</th>
                <th>Estoque Atual</th>
                <th>Estoque Mínimo</th>
                <th>Movimentação (Entrada/Saída)</th>
            </tr>
        </thead>
        <tbody>
            {% for produto in produtos %}
            <tr>
                <td>
                    {{ produto.nome }}
                    {% if produto.abaixo_do_minimo %}
                        <br><strong class="alert-warning" style="padding: 2px 6px; border-radius: 4px; font-size: 0.85rem;">Estoque Baixo!</strong>
                    {% endif %}
                </td>
                <td>{{ produto.quantidade_estoque }}</td>
                <td>{{ produto.estoque_minimo }}</td>
                <td>
                    <form action="{% url 'movimentar_estoque' produto.pk %}" method="post" style="display: flex; gap: 5px; align-items: center; margin: 0;">
                        {% csrf_token %}
                        <input type="number" name="quantidade" placeholder="Qtd" required style="width: 80px; padding: 0.5rem; margin: 0;">
                        <button type="submit" name="tipo" value="E" class="btn btn-success" style="padding: 0.5rem 0.8rem;">Entrada</button>
                        <button type="submit" name="tipo" value="S" class="btn btn-danger" style="padding: 0.5rem 0.8rem;">Saída</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">Nenhum produto para gerenciar.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}